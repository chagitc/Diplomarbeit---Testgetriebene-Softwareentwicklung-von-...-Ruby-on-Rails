\chapter{Anwendung der Testgetriebenen Entwicklung}
\label{sec:awtdd}

In den nachfolgenden Abschnitten wird examplarisch an dem Objekt "`Job"', also der internen Repräsentation einer Stellenanzeige, die Testgetriebene Entwicklung mit praktischen Beispielen näher erläutert.
Besonderes Augenmerk soll dabei auf den Entwicklungsfluss von \glossar{TDD} gelegt werden. Zu dessen Verdeutlichung ist am Dokumentenrand die jeweilige Phase innerhalb des TDD-Zyklus zufinden (Red, Green, Refactor), dem die im Text gezeigten Codeabschnitte zuzuordnen sind.

Ziel dieses Kapitels wird es sein, einen Überblick über die Art und Weise zu erhalten, mit denen die verschiedenen Teilbereiche einer Webanwendung testgetrieben entwickelt werden können.
Die ersten beiden Abschnitte richten sich an zwei der Grundbausteine einer \glossar{MVC} (vgl. Abschnitt \ref{sec:railsconcepts}).
Webanwendung, den Modell- und Controllertests. Im Dritten Abschnitt sehen wir, wie Test Doubles verwendet werden können, um Zugriffe auf externe Datenlieferanten zu simulieren. Danach betrachten wir die Anwendung aus Anwendersicht, und widmen wir uns der Implementierung von Akzeptanz- und Systemtests (vgl. Abschnitt \ref{sec:acceptance}). 
Zum Schluss gibt es einen Ausblick auf das Testen von Javascript-Ereignissen.

\input{parts/praxis/anwendung_unittest}
\input{parts/praxis/anwendung_functional}
\input{parts/praxis/anwendung_feedimport}
\input{parts/praxis/anwendung_akzeptanz}

\section{Testen von Javascript}

Mit dem ständig zunehmenden Grad der Entwicklung von Javascript-Frameworks und den in den letzten Jahren zunehmenden Ausführungsgeschwindigkeiten von Javascript in den einzelnen Browsern, ist Javascript bei der Programmierung von modernen Webanwendung ein immer wichtigerer Teil geworden. Das Aufkommen von Cloud-Computing propagiert die Ablösung traditioneller Desktop-Software durch browserbasierte Anwendungen. So beinhaltet fast jede moderne Webanwendung Javascript-Funktionalität.

Meist geschieht dies durch \textbf{Ajax}\footnote{Asynchrones Javascript und XML (oder JSON)}, also durch asynchrone Kommunikation mit einem Server und Aktualisieren der Seite ohne dass diese neugeladen werden muss. Durch sehr gute Frameworks, wie z.B. \textbf{jQuery}, dass ab Rails\index{Ruby-on-Rails} 3 standardmäßig Teil der Rails-Distribution ist, sind solche Aktualierungen meist in sehr wenigen Zeilen zu implementieren. Aber auch diese Zeilen sind Teil unseres Applikationscodes, und es existiert ein Bedürfnis diesen Teil ebenfalls zu testen.

\paragraph{Test im Rahmen von Systemtests} Die für uns leichteste Methode, ist das Testen von Javascript im Rahmen unserer System/Akzeptanztest\index{Test!Akzeptanztest}, die bereits im voherigen Abschnitt waren. Dafür müssen wir nur eine Browser-Engine wählen, die Javascript ausführen kann. Für die Browsersimulation nahmen wir Capybara\index{Capybara}, haben also nun leicht die Möglichkeit die Engine zu wechseln. So kann z.B. mittels der Middleware Selenium\index{Selenium} Firefox oder Chrome simuliert werden. Dies verzögert zwar unsere Testausführung, stellt aber sicher, dass auch Javascript in einer Umgebung ausgeführt wird, die der letztendlichen Realen des Benutzers sehr nahe kommt.

\paragraph{Dedizierte Unittest\index{Test!Unittest}s für Javascript} Falls eine Anwendung nicht nur einfache Ajax-Funktionen der Art "`Klicke Link -- Sende Anfrage an Server -- setzte fertiggenerierten HTML Code der Antwort direkt in den DOM ein"', sondern Funktionen, die klassische Desktopanwendungen nachbilden, gefordert sind, ist der Einsatz von eigenen Unittests für Javascript angebracht.
Diese Art der Anwendungsgestaltung gewinnt zunehmend an Popularität, z.B. das aktuelle Twitter-Layout oder Google Mail machen nach dem initialen Laden der Webseite keine weitere komplette Seitenaktualisierung mehr. 
Auch hier bieten sich einige Javascript Test-Frameworks an, z.B. JsUnit\footnote{http://www.jsunit.net/}, einem Vertreter der xUnit-Reihe, und Jasmine\footnote{\url{http://pivotal.github.com/jasmine/}}, einem Vertreter aus dem \glossar{BDD}-Kontext (vgl. Abschnitt \ref{sec:tddBdd}). 

Bei IT-Jobs beschränkt sich der Einsatz von Javascript allerdings auf die erwähnten einfachen DOM-Manipulationen.

\paragraph{Diskussion} Das explizite Testen von Javascript ist zwar nicht Thema dieser Diplomarbeit, aber im Kontext der Entwicklung einer Webanwendung sollte Javascript nicht unerwähnt bleiben. Für die vorliegende Anwendung IT-jobs hat die Methode, Javascript im Rahmen von Systemtests zu testen, ausgereicht. Für komplexe Javascriptanwendungen sind aber unbedingt dedizierte Unittest\index{Test!Unittest}s erforderlich.
