\appendix

\section{Nutzung von Cucumber in Verbindung mit Selenium für Firefox und Guard ohne X-Server}
Für ein effektives Test-Setup wurden folgende Testtools benutzt
\begin{description}
 \item[Guard] Automatische Testausführung bei Änderungen der Dateien
 \item[Xvfb] Ist ein X-Server, der ohne Grafikausgabe arbeitet. Er eignet sich also für die Ausführung von GUI-Programmen, wie Mozilla Firefox auf Remote-Servern.
 \item[Selenium] Interface zur Fernsteuerung von Browsern
 \item[Spork] Erhöht die Testausführungsgeschwindigkeit, da Teile von Rails im Hintergrund gehalten werden, und zwischen den Tests nicht neu geladen werden müssen
\end{description}

\subsection*{Installation}
Es muss bereits installiert sein: firefox, xvfb, Rails > 3.0 
\begin{enumerate}
 \item In das Gemfile folgendes eintragen:
 \begin{lstlisting}[caption=RAILS\_ROOT/Gemfile]
group :test, :cucumber do
  gem "capybara"
  gem 'cucumber'
  gem "cucumber-rails"
  gem 'database_cleaner'
  gem "launchy"
  gem "guard"
  gem 'guard-cucumber'
  gem 'guard-spork'
  gem "rb-inotify"  # Für Linux
  gem "spork", :git => "git://github.com/timcharper/spork.git"
end

 \end{lstlisting}
 Danach folgendes ausführen:
 
 \begin{verbatim}
bundle install
rails g cucumber:install
 \end{verbatim}


 \item Eine Datei Guardfile anlegen. Hier kommen alle Anweisungen zur Steuerung von guard hinein
 \begin{lstlisting}[caption=RAILS\_ROOT/Guardfile]
group "cucumber" do
  guard 'spork' do
    watch('config/application.rb')
    watch('config/environment.rb')
    watch('features/support/env.rb')
    watch(%r{^config/environments/.+\.rb$})
    watch(%r{^config/initializers/.+\.rb$})
    watch('spec/spec_helper.rb')
  end
  guard 'cucumber', :cli => '--no-profile --color --format pretty --strict RAILS_ENV=test' do
    watch(%r{^features/.+\.feature$})
    watch(%r{^features/support/.+$})                      { 'features' }
    watch(%r{^features/step_definitions/(.+)_steps\.rb$}) { |m| Dir[File.join("**/#{m[1]}.feature")][0] || 'features' }
  end
end 
\end{lstlisting}
\item In der Datei \texttt{config/cucumber.yml} die Option \texttt{--drb} für "`default"' und "`wip"' setzen. 


\item Die Datei \texttt{features/support/env.rb} anpassen, um sie mit Spork kompatibel zu machen
\begin{lstlisting}[caption=features/support/env.rb]
require 'cucumber/rails'
require "spork"
require 'test/unit/testresult'
Test::Unit.run = true

Spork.prefork do
  ENV["RAILS_ENV"] ||= "test"
  require File.expand_path(File.dirname(__FILE__) + '/../../config/environment')
  require 'cucumber/formatter/unicode' 
  require 'cucumber/rails'
  require 'test/unit/testresult'
  ActionController::Base.allow_rescue = false
  begin
    DatabaseCleaner.strategy = :truncation
  rescue NameError
    raise "You need to add database_cleaner to your Gemfile (in the :test group) if you wish to use it."
  end
end

Spork.each_run do
  require 'cucumber/rails/world'
end

\end{lstlisting}

\end{enumerate}


\subsection*{Nutzung}

\begin{enumerate}
 \item Aktivierung von Xvfb auf Displayport 99
 \begin{verbatim}
  Xvfb :99 -ac
 \end{verbatim}
 
 \item Aktuelle Shell auf diesen Displayport einstellen
 \begin{verbatim}
  export DISPLAY=:99
 \end{verbatim}
 
 \item Guard starten
 \begin{verbatim}
  guard -g cucumber
 \end{verbatim}
\end{enumerate}

Nun werden automatisch alle Cucumber-Features getestet. Falls Selenium verwendet wird, dann wird der Firefox im Hintergrund gestartet, ohne dass dies sichtbar wird.



\section{Nutzung von deutschen Schlüsselwörtern für Cucumber Features}

In dieser Diplomarbeit wurde die deutsche Modifikation für Cucumber verwendet. Da Cucumber in erster Linie als Kommunikationsmittel zum Kunden dient, ist es hilfreich, die Features in dessen Sprache zu schreiben.

Dazu die Datei \texttt{features/support/i18n.yml} anlegen.

\begin{lstlisting}[name=cucumber-lang,caption=features/support/i18n.yml,label=cucumber-lang]
# encoding: UTF-8
"de":
  name: German
  native: Deutsch
  feature: Funktionalität|Feature
  background: Grundlage
  scenario: Szenario
  scenario_outline: Szenariogrundriss
  examples: Beispiele
  given: "*|Angenommen|Gegeben sei"
  when: "*|Wenn"
  then: "*|Dann"
  and: "*|Und"
  but: "*|Aber"
\end{lstlisting}

Dazu einen Loader programmieren, der die Sprachdatei vor der Ausführung von Cucumber lädt.

\begin{lstlisting}[caption=features/support/i18n\_loader.rb]
# Include custom "german" language File for Cucumber
AfterConfiguration do |config|
  languages = YAML.load_file(File.expand_path(File.dirname(__FILE__) + '/i18n.yml'))
  Gherkin::I18n::LANGUAGES["de"] = Gherkin::I18n::LANGUAGES["de"].merge(languages["de"])
end
\end{lstlisting}



\newpage
\listoffigures



\addcontentsline{toc}{section}{Quellcode Listings}
\lstlistoflistings
%\listoflistings
\cite{*} 
%\bibliographystyle{dinat}
\bibliographystyle{dinat}
\bibliography{bibo}